<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="D. Spence" />


<title>OpenRefine for Talis Aspire users</title>

<script src="index_files/header-attrs-2.11/header-attrs.js"></script>
<script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/darkly.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>
<script src="index_files/kePrint-0.0.1/kePrint.js"></script>
<link href="index_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">OpenRefine for Talis Aspire users</h1>
<h4 class="author">D. Spence</h4>
<h4 class="date">13th of October, 2021</h4>

</div>


<div id="introduction-to-openrefine" class="section level1">
<h1>Introduction to OpenRefine</h1>
<p><a href="https://openrefine.org/">OpenRefine</a> (formerly Google Refine) is a tool for <a href="https://youtu.be/B70J_H_zAWM">exploring data</a> sets, <a href="https://youtu.be/cO8NVCs_Ba0">cleaning and transforming</a> it into something useful and <a href="https://youtu.be/5tsyz3ibYzk">enhancing it</a> into something even more useful. The goal of this guide is to explain the basics of OpenRefine using Talis Aspire data as an example. OpenRefine supports file types like XLS, CSV and MARC so it is very versatile for library workers.</p>
<p>I have been using OpenRefine to proactively find problems in reading lists and fix them procedurally. On the reports tab of Talis reading lists you can export a list of all published items in a comma separated values files. This can be then be imported into OpenRefine. Below I have included a table explaining what each of the fields translates to.</p>
<div id="installing-openrefine" class="section level2">
<h2>Installing OpenRefine</h2>
<p>The instructions to install OpenRefine can be found on the <a href="https://openrefine.org/download.html">OpenRefine download page</a>. It supports Windows, Mac and Linux and runs in your web browser. I have had success running it on my personal computer and on office computers. If you do not know whether you have Java installed on Windows, the version that comes bundled with Java is the easiest way to get started. As most university staff are no longer permitted to install software on campus computers I have requested OpenRefine be to the <a href="https://software.essex.ac.uk">University of Essex Software Hub</a>. This is currently in progress as of September 2021.</p>
</div>
<div id="downloading-talis-aspire-data" class="section level2">
<h2>Downloading Talis Aspire data</h2>
<p>Data can be downloaded from <a href="https://essex.rl.talis.com/reports/523E347F-38CF-E58D-929C-326B7FF25E75.html">Talis Aspire Reports</a>. For this guide I have been focusing on the All List Items section as my role focuses on checking lists for errors. It is worth bearing in mind that larger data sets require more powerful computers. When I tried to import 603,000 items my computer seized up due to a lack of memory. By default OpenRefine caps out at one gigabyte (GB) of memory, jumping up to 2GB and 4GB allowed me to import the full data set with ease. Instructions on how to do this can be found in the <a href="https://subscription.packtpub.com/book/big_data_and_business_intelligence/9781783289080/1/ch01lvl1sec15/recipe-7-going-for-more-memory">Using OpenRefine book</a>. It is best practice to only work on what you think you need to because actions can get sluggish.</p>
<p>Filtering list status only to only published brings it down to a manageable 129,000. Depending on the status of rollover you may want to filter by Time Period to catch items that are unpublished. Once you have your data click download CSV. This will e.mail the Talis user a link to download the CSV file. For all published items this came out to about 53 megabytes.</p>
<p><img src="images/talisExportToCSV.png" title="Screenshot of the Talis Aspire's new All List Items report with filters for item, list types and date range." alt="Screenshot of the Talis Aspire's new All List Items report with filters for item, list types and date range." width="98%" style="display: block; margin: auto;" /></p>
</div>
<div id="importing-data-into-refine" class="section level2">
<h2>Importing data into Refine</h2>
<p>I found searching for the app via the Windows Start menu does not work so you may need to locate the install directory. Double click the OpenRefine icon where you installed it. For me this was C:\Users\Spence\Desktop\openrefine-3.4.1\openrefine.exe. This will open your default web browser to the URL <a href="http://127.0.0.1:3333/">http://127.0.0.1:3333/</a> this URL only works when the OpenRefine application is running. The home screen should have a browse button to locate the all_list_items_2021_04_12.csv you just downloaded. From there just click next and <em>Create Project</em> to start playing around with your data. Once you have created a project it will be visible on the Open Project tab to the left. It saves whatever you’ve done and has a full history.</p>
</div>
<div id="aspire-data-fields" class="section level2">
<h2>Aspire data fields</h2>
<p>Below I have included some notes on the fields Talis exposes. If you are familiar with editing reading lists most of this will look familiar but some of these fields are hidden. Knowing what field to filter first is the key to finding the right list items that most need attention.</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<strong>Table 1.</strong> list items report collumn headers with example fields and notes
</caption>
<thead>
<tr>
<th style="text-align:left;">
Field name
</th>
<th style="text-align:left;">
Example
</th>
<th style="text-align:left;">
Notes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Title
</td>
<td style="text-align:left;">
Managing and Organizations: An Introduction to Theory and Practice
</td>
<td style="text-align:left;">
Book title, where an article has no part this field will be used instead of the below field
</td>
</tr>
<tr>
<td style="text-align:left;">
Chapter/Article
</td>
<td style="text-align:left;">
Managing Individuals
</td>
<td style="text-align:left;">
Chapter title, if used
</td>
</tr>
<tr>
<td style="text-align:left;">
Item Link
</td>
<td style="text-align:left;">
<a href="http://readinglists.essex.ac.uk/items/5d6776ef-6f78-40bb-b8f4-536d0db63e10" class="uri">http://readinglists.essex.ac.uk/items/5d6776ef-6f78-40bb-b8f4-536d0db63e10</a>
</td>
<td style="text-align:left;">
Links directly to the bookmark so you can preview it
</td>
</tr>
<tr>
<td style="text-align:left;">
Author(s)
</td>
<td style="text-align:left;">
Clegg, Stewart R.; Kornberger, Martin; Pitsis, Tyrone S.; Mount, Matt
</td>
<td style="text-align:left;">
Chapter author takes priority over book author, shown at top level. Sometimes this contains a full name in a single name field.
</td>
</tr>
<tr>
<td style="text-align:left;">
Editor(s)
</td>
<td style="text-align:left;">
Bloggs, Joe
</td>
<td style="text-align:left;">
Editor is only shown when bookmark is expanded
</td>
</tr>
<tr>
<td style="text-align:left;">
List appearance
</td>
<td style="text-align:left;">
AB123: Some subject
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
List Link
</td>
<td style="text-align:left;">
<a href="http://readinglists.essex.ac.uk/lists/9C9EE6E3-556A-071E-EE4D-59CE13C35432" class="uri">http://readinglists.essex.ac.uk/lists/9C9EE6E3-556A-071E-EE4D-59CE13C35432</a>
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Type
</td>
<td style="text-align:left;">
Chapter, Audio Visual Document etc.
</td>
<td style="text-align:left;">
Selected from the Resource Type drop down menu. When a bookmark is part of a book or journal the has part type takes priority over the part of
</td>
</tr>
<tr>
<td style="text-align:left;">
Importance
</td>
<td style="text-align:left;">
Essential, Core, Supplementary etc.
</td>
<td style="text-align:left;">
Blank if not set. There are some lists that contain deprecated importance such as Supplementary and Further. Helpful for finding essential items that are not available in the catalogue
</td>
</tr>
<tr>
<td style="text-align:left;">
ISBN10
</td>
<td style="text-align:left;">
1526487969
</td>
<td style="text-align:left;">
Mostly used for books published before 2007
</td>
</tr>
<tr>
<td style="text-align:left;">
ISBN13
</td>
<td style="text-align:left;">
9781526460103; 9781526460097; 9781526487964
</td>
<td style="text-align:left;">
13 digit ISBN. Talis takes the book art from the first ISBN13. In testing I have found that the paperback usually is the most reliable ISBN13 to contain book art for the reading list.
</td>
</tr>
<tr>
<td style="text-align:left;">
ISSN
</td>
<td style="text-align:left;">
1234-5678
</td>
<td style="text-align:left;">
Print ISSN, often the EISSN is listed as ISSN. Electronic ISSN. Ideally split in the middle by a hyphen to ensure compatibility with Talis Aspire Digitised Content
</td>
</tr>
<tr>
<td style="text-align:left;">
EISSN
</td>
<td style="text-align:left;">
8765-4321
</td>
<td style="text-align:left;">
Electronic ISSN.
</td>
</tr>
<tr>
<td style="text-align:left;">
LCN
</td>
<td style="text-align:left;">
2304268
</td>
<td style="text-align:left;">
Record number from the catalogue. Where a dual bookmark is used the print LCN must come first. Only works with b records Re2304268 would incorrectly link direct to the Rb2304268
</td>
</tr>
<tr>
<td style="text-align:left;">
DOI
</td>
<td style="text-align:left;">
10.4135/9781446218563
</td>
<td style="text-align:left;">
Talis generates <a href="https://0-doi-org.serlib0.essex.ac.uk/10.4135/9781446218563" class="uri">https://0-doi-org.serlib0.essex.ac.uk/10.4135/9781446218563</a> for the student. A DOI will automatically create a chapter/article DOI and book DOI even if no direct DOI to the chapter exists.
</td>
</tr>
<tr>
<td style="text-align:left;">
Date of publication
</td>
<td style="text-align:left;">
2019
</td>
<td style="text-align:left;">
2019
</td>
</tr>
<tr>
<td style="text-align:left;">
Issue
</td>
<td style="text-align:left;">
4, Spring
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Volume
</td>
<td style="text-align:left;">
87
</td>
<td style="text-align:left;">
Often used for journals but occasionally for a series of books too. The bookmarklet sometimes get false positives for this field sometimes
</td>
</tr>
<tr>
<td style="text-align:left;">
Edition
</td>
<td style="text-align:left;">
5th
</td>
<td style="text-align:left;">
Book edition
</td>
</tr>
<tr>
<td style="text-align:left;">
Start page
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Some older bookmarks feature page range in a single field
</td>
</tr>
<tr>
<td style="text-align:left;">
End page
</td>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Publisher
</td>
<td style="text-align:left;">
SAGE Publications
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Format
</td>
<td style="text-align:left;">
physical
</td>
<td style="text-align:left;">
Appears to be unused, some older bookmarks refer to whether it is hardbound or print
</td>
</tr>
<tr>
<td style="text-align:left;">
Web Address
</td>
<td style="text-align:left;">
<a href="https://publisher.com/book/chapter1" class="uri">https://publisher.com/book/chapter1</a>; <a href="https://publisher.com/book/chapter2" class="uri">https://publisher.com/book/chapter2</a>
</td>
<td style="text-align:left;">
Generally a copy of the Primary Web Address field
</td>
</tr>
<tr>
<td style="text-align:left;">
Time Period
</td>
<td style="text-align:left;">
2021/22
</td>
<td style="text-align:left;">
Can be used to filter by academic year
</td>
</tr>
<tr>
<td style="text-align:left;">
Date Added
</td>
<td style="text-align:left;">
25/03/21
</td>
<td style="text-align:left;">
Date bookmark originally added to Talis Aspire
</td>
</tr>
<tr>
<td style="text-align:left;">
Added By
</td>
<td style="text-align:left;">
Sloman,Albert
</td>
<td style="text-align:left;">
Person that added the bookmark to Talis Aspire
</td>
</tr>
<tr>
<td style="text-align:left;">
Last Published
</td>
<td style="text-align:left;">
14/05/21
</td>
<td style="text-align:left;">
Date the item was last published on Talis Aspire
</td>
</tr>
<tr>
<td style="text-align:left;">
Library Note
</td>
<td style="text-align:left;">
Please can you purchase this as an eBook?
</td>
<td style="text-align:left;">
Only visible to academic and library staff
</td>
</tr>
<tr>
<td style="text-align:left;">
Student Note
</td>
<td style="text-align:left;">
Read chapter 2. This is important with regards to your assignments
</td>
<td style="text-align:left;">
Used to provide context or instruction on a bookmark
</td>
</tr>
<tr>
<td style="text-align:left;">
CKEY
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Appears to be unused
</td>
</tr>
<tr>
<td style="text-align:left;">
TADC Request ID
</td>
<td style="text-align:left;">
16901
</td>
<td style="text-align:left;">
Matches the Talis Aspire Digitised Content request number
</td>
</tr>
<tr>
<td style="text-align:left;">
TADC Request Status
</td>
<td style="text-align:left;">
EXPIRED, LIVE, REFERRED, REJECTED, SUCCESS, WITHDRAWN
</td>
<td style="text-align:left;">
Status from Talis Aspire Digitised Content. Note: LIVE may be inaccessible outside of the lists term dates as speicifed in the module hierarchy
</td>
</tr>
<tr>
<td style="text-align:left;">
TADC Bundle ID
</td>
<td style="text-align:left;">
609e95091b02c916396a12c4
</td>
<td style="text-align:left;">
Used to link to the PDF, on the list this is automatically turned into <a href="https://content.talisaspire.com/essex/bundles/609e95091b02c916396a12c4" class="uri">https://content.talisaspire.com/essex/bundles/609e95091b02c916396a12c4</a> for the student
</td>
</tr>
<tr>
<td style="text-align:left;">
Has Container
</td>
<td style="text-align:left;">
tenantSections:82C5A361-B412-5E12-CADA-7756EFC4D76D
</td>
<td style="text-align:left;">
This relates to the structure and order the reading list. tenantSection indicates the bookmark is part of a section, like Week 9. tenantList indicates the bookmark is just on the root of the list.
</td>
</tr>
<tr>
<td style="text-align:left;">
Primary Web Address
</td>
<td style="text-align:left;">
<a href="https://publisher.com/book/chapter1" class="uri">https://publisher.com/book/chapter1</a>; <a href="https://publisher.com/book/chapter2" class="uri">https://publisher.com/book/chapter2</a>
</td>
<td style="text-align:left;">
Chapter, Article etc. URL
</td>
</tr>
<tr>
<td style="text-align:left;">
Secondary Web Address
</td>
<td style="text-align:left;">
<a href="https://publisher.com/book" class="uri">https://publisher.com/book</a>
</td>
<td style="text-align:left;">
Book, Journal etc. URL
</td>
</tr>
<tr>
<td style="text-align:left;">
Online Resource
</td>
<td style="text-align:left;">
<a href="https://publisher.com/book/chapter1" class="uri">https://publisher.com/book/chapter1</a>
</td>
<td style="text-align:left;">
Filled in when the Online Resource is checked on the Talis Aspire bookmark. Copied from the below instruction
</td>
</tr>
<tr>
<td style="text-align:left;">
Online Resource Source
</td>
<td style="text-align:left;">
Web Address
</td>
<td style="text-align:left;">
Selects which of the above fields (Web Address, DOI) the VIEW ONLINE button bookmark points to. If this field is blank it means that the <strong>VIEW ONLINE</strong> button is hidden from the top of the reading list. A good way to filter out items that are not currently available or listed digitally.
</td>
</tr>
</tbody>
</table>
<p>It has been difficult to detect the precedence of Web Address and Primary Web Address. Need to investigate which field or fields Joe Munzer’s bulk upload tool works on.</p>
</div>
</div>
<div id="filtering-data" class="section level1">
<h1>Filtering data</h1>
<div id="text-filters" class="section level2">
<h2>Text filters</h2>
<p>Large data sets are cumbersome. The first thing you might want to do is a simple text filter. It searches the entire column for any cell contains what you type. The great thing about this is that it is interactive so your results update as you type each character. By clicking the arrow left of <strong>List Appearance</strong> and clicking <strong>Filter &gt; Text Filter</strong> File you can now search for all reading lists that contain the word Southend which for me narrows down to 3518 items. Note the invert toggle on the left side will allow you to search for fields that does not contain your query. You can layer up searches on multiple columns to really drill down on specific issues.</p>
<p><img src="images/textfilteringsouthend.jpg" title="Screenshot of the text filter modifier in OpenRefine. The search filter is Southend and several reading lists taught on the Southend campus are displayed" alt="Screenshot of the text filter modifier in OpenRefine. The search filter is Southend and several reading lists taught on the Southend campus are displayed" width="98%" style="display: block; margin: auto;" /></p>
</div>
<div id="faceting" class="section level2">
<h2>Faceting</h2>
<p>Faceting finds commonalities between cells and groups them together, sort of like pivot tables in Excel. On the <strong>Importance</strong> column click facet and perform a text facet. This now allows us to toggle items. I have 695 Essential items and 89 Core items. Clicking Essential or Core will give you one set but if you mouse over additional fields you can include them. For this example include all Core and Essential items.</p>
<p><img src="images/faceting.jpg" title="Screenshot of the facet modifier in OpenRefine. The Essential importance has been isolated and the mouse is hovering over the core field showing the include option." alt="Screenshot of the facet modifier in OpenRefine. The Essential importance has been isolated and the mouse is hovering over the core field showing the include option." width="98%" style="display: block; margin: auto;" /></p>
<p>I have found faceting really useful for finding where the same books are used across multiple reading lists or which list contains the most problems (such as lacking a LCN). If you want to see an example or where it is really powerful try doing it on the <strong>Edition</strong> column.</p>
</div>
<div id="querying-a-column" class="section level2">
<h2>Querying a column</h2>
<p>Lets say we want to find out which of the essential items taught at Southend do not contain a Southend local control number? To do this we click <strong>LCN &gt; Edit column &gt; Add column based on this column</strong>. Give the new column name a title like No Spydus link. Here we can query the cell value using an expression. The <code class="javascript">value.contains()</code> command will check to see if a cell contains a value and return a true or false. So typing the below line will return false for any essential bookmarks that don’t contain a Southend LCN.</p>
<pre class="javascript"><code>value.contains(&quot;ECC&quot;)</code></pre>
<p><img src="images/southendquery.jpg" title="Screenshot of the Add column window in OpenRefine. New column name is &quot;No Spydus link&quot;, on error is set to blank, expression is value.contains(&quot;ECC&quot;). The results show true and false depending on the cell contents" alt="Screenshot of the Add column window in OpenRefine. New column name is &quot;No Spydus link&quot;, on error is set to blank, expression is value.contains(&quot;ECC&quot;). The results show true and false depending on the cell contents" width="98%" style="display: block; margin: auto;" /></p>
<p>The preview tab shows a dozen examples in real-time as you type so you can experiment with your expression until you get the desired results. If you have a good filter you may see a variety of results depending on the data.</p>
<div id="further-text-faceting" class="section level3">
<h3>Further text faceting</h3>
<p>Running another facet on the newly created <strong>No Spydus link</strong> column narrows it down even further. Blank may indicate an essential reading on an external website or a Kortext item that does not yet have a catalogue record yet. A plain LCN may indicate an electronic resource.</p>
<p>As a practice exercise you could try putting in the skills you have learned so far to find a print book that can be found in the Southend Spydus catalogue which is not yet linked correctly on Aspire.</p>
</div>
</div>
<div id="regular-expressions" class="section level2">
<h2>Regular expressions</h2>
<p>Regular expressions are similar to a standard find and replace but they have the ability to include wildcards. Say you wanted to find all papers discussing labour, instead of searching twice for the American English spelling labour you can just use the regular expression labou?r. The question mark indicates the u is optional. Many fields have inconsistencies. They might lack a semicolon or use an &amp; in one bookmark and ‘and’ in the next. Regular expression is pretty daunting but a lot of the time the hard work is done for you if you to a web search. John Little has an <a href="https://www.johnlittle.info/project/custom/regex/regex.html">Intro to RegEx</a> which expands on this well.</p>
</div>
</div>
<div id="transforming-data" class="section level1">
<h1>Transforming data</h1>
<div id="fixing-urls" class="section level2">
<h2>Fixing URLs</h2>
<p>One of the simpler tasks but most useful is a find and replace. A common example is a URL that does not contain the University of Essex proxy. Say you have found some unauthenticated DOI.org URLs by running a text filter of “://doi.org/.” In my case I have 101 results on the <strong>Online Resource Web Address</strong> field, so we will work on that one. From browsing the data I find 4 types of leading text:</p>
<ul>
<li><a href="https://doi.org/" class="uri">https://doi.org/</a>…<br />
</li>
<li><a href="http://doi.org/" class="uri">http://doi.org/</a>…</li>
<li><a href="https://dx.doi.org/" class="uri">https://dx.doi.org/</a>…</li>
<li><a href="http://dx.doi.org/" class="uri">http://dx.doi.org/</a>…</li>
</ul>
<p>We will tackle the top one first and then modify the expression to cover the others. On the <strong>Online Resource Web Address</strong> column click <strong>Edit Column &gt; Add column based on the column</strong> and use the following GREL expression:</p>
<pre class="javascript"><code>value.replace(&quot;https://doi.org/&quot;, &quot;https://0-doi-org.serlib0.essex.ac.uk/&quot;) </code></pre>
<p>If you delete the s in https you can see in real-time how the expression works on different cells. Now if we want to work on more than one type of cell in one go we can chain them using if logic as below.</p>
<pre><code>if URL contains = https://doi.org/ (A)
  swap for https://0-doi-org.serlib0.essex.ac.uk/ (B)
  job done, move to next cell
else if URL contains http://doi.org/ (C)
  swap for https://0-doi.org.serlib0.essex.ac.uk/ (D)
  job done, move to next cell
else if URL contains https://dx.doi.org/ (E)
  swap for https://0-doi-org.serlib0.essex.ac.uk/ (F)
  move to next cell
else if URL contains http://dx.doi.org/ (G)
  swap for https://0-dx-doi.org.serlib0.essex.ac.uk/ (H)
  move to next cell
give up</code></pre>
<p>To try and make it simpler I have written out the following which corresponds to the letters above: If A is true do B, otherwise if C is true do D, otherwise if E is true do F, otherwise if G is true do H, otherwise give up.</p>
<p>All it is trying to do is say try this, if that doesn’t work try the next thing until you get to the end. Sometimes it isn’t possible to write code for every use case. It is a garbage-in-garbage-out process. If you have a dozen odd URLs at the end that you can’t fix programmatically it may be quicker to correct those manually. Wrapping it up in GREL looks something like this:</p>
<pre class="javascript"><code>if(value.startsWith(&quot;https://doi.org/&quot;),value.replace(&quot;https://doi.org&quot;, &quot;https://0-doi-org.serlib0.essex.ac.uk/&quot;),if(value.startsWith(&quot;http://doi.org/&quot;),value.replace(&quot;http://doi.org&quot;, &quot;https://0-doi-org.serlib0.essex.ac.uk/&quot;), if(value.startsWith(&quot;https://dx.doi.org/&quot;), value.replace(&quot;https://dx.doi.org&quot;, &quot;https://0-dx-doi-org.serlib0.essex.ac.uk/&quot;), if(value.startsWith(&quot;http://dx.doi.org/&quot;),value.replace(&quot;http://dx.doi.org&quot;, &quot;https://0-dx-doi-org.serlib0.essex.ac.uk/&quot;), value)))) </code></pre>
<p>You have to be careful with any fail states because the bulk upload tool will interpret an empty null field as you saying delete the existing URL. It’s always worthwhile taking a glance at your fields before uploading in case you end up telling it to delete URLs that still need fixing.</p>
<p>I have chosen to force https instead of preserving http in line with <a href="https://www.crossref.org/blog/linking-dois-using-https-the-background-to-our-new-guidelines/">Crossref’s recommendation</a>. I have not come across any examples of https causing an issue. Where an article is open access I have left it as doi.org because it is against the spirit of open access to lock it behind an Essex account. One way we could isolate these is by including a hashtag #openaccess in the library note field or including #oa after the URL to exclude those URLs.</p>
<p><img src="images/DOIscript.png" title="Screenshot of the Add column window in OpenRefine. The find and replace script is working on a variety of doi.org URLs to add the Essex proxy." alt="Screenshot of the Add column window in OpenRefine. The find and replace script is working on a variety of doi.org URLs to add the Essex proxy." width="98%" style="display: block; margin: auto;" /></p>
<p>The helpful yellow popup tells us that we have modified 101 fields which is what we filtered to. Checking these URLs they appear to work great.</p>
<p><img src="images/changedRecords.png" title="Screenshot of the changes OpenRefine has made. The number of records in the pop up matches the record number confirming action has been taken on every field." alt="Screenshot of the changes OpenRefine has made. The number of records in the pop up matches the record number confirming action has been taken on every field." width="98%" style="display: block; margin: auto;" /></p>
<p>I have found this technique useful for fixing DOI, HeinOnline, Westlaw URLs and I believe it will be useful for Box of Broadcasts also. Using Joe Munzer’s tool allows us to fix hundreds of URLs in one go that would take hours to find and fix by hand. If the library switches to a different proxy service this will come in very useful. One thing I have started doing is including a hashtag in the library note for #openaccess. This way when the script is run in the future it does not alter open access items because that would be locking free content behind an Essex login.</p>
</div>
<div id="exporting-for-joes-bulk-upload-tools" class="section level2">
<h2>Exporting for Joe’s bulk upload tools</h2>
<p>Exporting is really easy. Three components are required Item ID, Old URL and New URL. To get the Item ID you will need to take the Item Link Collumn and modify it using the following command.</p>
<pre class="javascript"><code>  value.replace(&quot;http://readinglists.essex.ac.uk/items/&quot;,&quot;&quot;) </code></pre>
<p>This should look something like the following:</p>
<p><img src="images/openRefineFindAndReplace.png" title="Screenshot of the transform cell window stripping out the pre-fix of the reading list URL leaving only the list code." alt="Screenshot of the transform cell window stripping out the pre-fix of the reading list URL leaving only the list code." width="98%" style="display: block; margin: auto;" /></p>
<p>Initially I tried using the <code>value.slice(38)</code> function. I found the replace method to be more precise because URLs can be so inconsistent. Slice can be really handy if you want to extract something from the middle because you can put in a second field to remove leading and trailing characters.</p>
<p>Once you have finished transforming your New URL field you just click <strong>Export &gt; Comma-separated value</strong>.</p>
</div>
</div>
<div id="enhancing-data" class="section level1">
<h1>Enhancing data</h1>
<div id="rows-vs.-records" class="section level2">
<h2>Rows vs. records</h2>
<p>Open Refine has two options in the top left, rows and records. Rows behaves like normal spreadsheet software where each line has its own number. Records for Aspire data is more bookmark focused, so a single bookmark would be one record number but could have multiple lines in the record for each appearance on various modules and reading lists. Aspire stores multiple ISBNs, URLs, authors in semicolon separated list. The easiest way to compare between two databases is to get an exact match. If we go to <strong>ISBN13 &gt; Edit Cells &gt; Split multi-valued cells…</strong> you can split the field into several rows using the ; delimiter. This will create a row for each ISBN13 in your matching selection. If you are comparing ISBNs between databases it is much simpler to compare data one piece at a time and splitting into rows allows this. If you’re done with your comparison or editing and want to go back just reverse the process by clicking <strong>ISBN13 &gt; Edit Cells &gt; Join multi-valued cells…</strong> using the delimiter of your choice.</p>
</div>
<div id="cross-command" class="section level2">
<h2>Cross command</h2>
<p>The Cell cross command is one of the easiest ways to find matching data between database A and database B, returning the cell of your from database B to enhance database B. One use case I have found is comparing ISBN13 or DOI in the reading list database with an open access repository/directory. In this example I am continuing from the above section where I split out the ISBN13s into rows. I am then going to do the same on the directory of open access book, which I have imported into Open Refine using the project title DOAB. The below video from <a href="https://ruthtillman.com/talk/cell-cross-webinar-2020-03/">Ruth Tillman’s tutorial</a> is how I learned to use this tool.</p>
<iframe width="784" height="425" src="https://www.youtube.com/embed/4ebiUv8cgOM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="regular-expressions-1" class="section level2">
<h2>Regular expressions</h2>
<p>Using the <code class="javascript">value.find()</code> command combined with a regular expression allows you to extract data from a cell. For instance ISBN13s beginning with 978, but might have hyphens or underscores</p>
<pre class="javascript"><code>value.find(/978[_-]?\d{1,3}[_-]?\d{1,3}[_-]?\d{1,3}[_-]?\d{1,4}/)[0]</code></pre>
<p>This tries to match all ISBNs. In my trial I got 8911 out of 8936, the other 25 were false positives that just happened to contain 978. From there you can simply find and replace all hyphens and underscores to get clean ISBNs for comparison. I am quite new to regular expressions so there are likely better examples of this online. Don’t waste your time trying to reinvent the wheel unless it helps you understand how regular expressions work.</p>
</div>
<div id="apis-and-comparing-data-sets" class="section level2">
<h2>APIs and comparing data sets</h2>
<p>There are a number of free and open access resources we can consult to save money when resourcing such as:</p>
<ul>
<li><a href="https://oapen.org/resources/15635975-metadata">OAPEN</a> - a managed repository of around 18,000 academic open access books with strong permanence</li>
<li><a href="https://www.doabooks.org/en/resources/metadata-harvesting-and-content-dissemination">Directory of Open Access Books</a> - links to around 44,000 open access books (incporates the OAPEN list)</li>
<li><a href="https://doaj.org/docs/public-data-dump/">Directory of Open Access Journals</a> – 16,500 open access peer reviewed journals. 3.5GB of article metadata</li>
<li><a href="https://unpaywall.org/products/data-feed">Unpaywall</a> - almost 30 million free scholarly articles, based on the Crossref DOI database (85GB)</li>
</ul>
<p>You can download these datasets and import them into OpenRefine and run comparison checks on them. As Unpaywall explains the status of open access can change from time to time (usually that older articles become open access) so downloading this data in full is not always the best way to work. A REST API lets you query the live data and you can do this in your browser as below:</p>
<p><a href="https://library.oapen.org/rest/search?query=9789047420552&amp;expand=metadata">https://library.oapen.org/rest/search?query=9789047420552&amp;expand=metadata</a></p>
<p><a href="https://directory.doabooks.org/rest/search?query=The%20Politics%20and%20Ethics%20of%20Representation%20in%20Qualitative%20Research&amp;expand=metadata">https://directory.doabooks.org/rest/search?query=The Politics and Ethics of Representation in Qualitative Research&amp;expand=metadata</a></p>
<p><a href="https://doaj.org/api/v2/search/journals/glossa">https://doaj.org/api/v2/search/journals/glossa</a></p>
<p><a href="https://api.unpaywall.org/v2/10.5114/hm.2018.76078?email=d.spence@essex.ac.uk">https://api.unpaywall.org/v2/10.5114/hm.2018.76078?email=d.spence@essex.ac.uk</a></p>
<p>You can search through a range of fields by consulting the API documentation, the above are some useful examples. As these services are free there is often a fair use policy to keep bandwidth costs down. For the resourcing I have done on essential items this is at most the tens of thousands and that has taken a while but been compliant. It is more practical to save the data locally if you are running large queries very regularly.</p>
<p>If you want to do this on scale you can use it in OpenRefine by concatenating the API strings with data you have in Aspire like DOI or ISBN.</p>
</div>
<div id="preparing-data" class="section level2">
<h2>Preparing data</h2>
</div>
</div>
<div id="round-up" class="section level1">
<h1>Round up</h1>
<p>This guide is a work in progress, I wanted to make something very specific to our platforms and not reinvent the wheel where great tutorials already exist. <a href="https://librarycarpentry.org/lc-open-refine/">Library Carpentry workshop</a> is one example. I want to thank Samantha at Suffolk Cooperative and the volunteers who gave their time to deliver it for allowing me to attend their workshops which covered several subjects. I am keen to collaborate on solutions if you think OpenRefine could help with your work. In the bibliography below I have included some links that I found useful while learning OpenRefine and writing this guide. If you have any comments, feedback or suggestions please get in touch with me by <a href="mailto:d.spence@essex.ac.uk?subject=OpenRefine%20for%20Talis%20Aspire%20users">email</a>.</p>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1 class="unnumbered">Bibliography</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-verborgh_2013" class="csl-entry">
De Wilde, Max, and Ruben Verborgh. 2013. <em>Using OpenRefine</em>. Packt. <a href="https://subscription.packtpub.com/book/big_data_and_business_intelligence/9781783289080/1/ch01lvl1sec15/recipe-7-going-for-more-memory">https://subscription.packtpub.com/book/big_data_and_business_intelligence/9781783289080/1/ch01lvl1sec15/recipe-7-going-for-more-memory</a>.
</div>
<div id="ref-gilmartin_2011" class="csl-entry">
Gilmartin, Andrew. 2015. <span>“DOIs and Matching Regular Expressions.”</span> Crossref Blog. CrossRef. August 11, 2015. <a href="https://www.crossref.org/blog/dois-and-matching-regular-expressions/">https://www.crossref.org/blog/dois-and-matching-regular-expressions/</a>.
</div>
<div id="ref-refineintroa" class="csl-entry">
GoogleRefine. 2011a. <span>“Google Refine 2.0 - Data Augmentation (3 of 3) (Video Version 2).”</span> YouTube. July 19, 2011. <a href="https://youtu.be/5tsyz3ibYzk">https://youtu.be/5tsyz3ibYzk</a>.
</div>
<div id="ref-refineintroc" class="csl-entry">
———. 2011b. <span>“Google Refine 2.0 - Data Transformation (2 of 3) (Video Version 2).”</span> YouTube. July 19, 2011. <a href="https://youtu.be/cO8NVCs_Ba0">https://youtu.be/cO8NVCs_Ba0</a>.
</div>
<div id="ref-refineintrob" class="csl-entry">
———. 2011c. <span>“Google Refine 2.0 - Introduction (1 of 3) (Video Version 2).”</span> YouTube. July 19, 2011. <a href="https://youtu.be/B70J_H_zAWM">https://youtu.be/B70J_H_zAWM</a>.
</div>
<div id="ref-hon_2021" class="csl-entry">
Hon, YiWen. 2021. <span>“OpenRefine for NHS Librarians.”</span> The Adventures of YiWen the Librarian. April 5, 2021. <a href="https://yiwenthelibrarian.wordpress.com/2021/04/05/openrefine-for-nhs-librarians/">https://yiwenthelibrarian.wordpress.com/2021/04/05/openrefine-for-nhs-librarians/</a>.
</div>
<div id="ref-little_201701" class="csl-entry">
Little, John. 2017a. <span>“OpenRefine: Data Cleaning, Faceting, and Transformations.”</span> Data &amp; Visualization Services Department, Duke University Libraries. January 24, 2017. <a href="https://warpwire.duke.edu/w/-4YBAA/">https://warpwire.duke.edu/w/-4YBAA/</a>.
</div>
<div id="ref-little_201707" class="csl-entry">
———. 2017b. <span>“Intro to Regular Expressions (RegEx).”</span> Data &amp; Visualization Services Department, Duke University Libraries. July 11, 2017. <a href="https://www.johnlittle.info/project/custom/regex/regex.html">https://www.johnlittle.info/project/custom/regex/regex.html</a>.
</div>
<div id="ref-little_2018" class="csl-entry">
———. 2018. <span>“Cleaning Data with OpenRefine.”</span> Data &amp; Visualization Services Department, Duke University Libraries. June 25, 2018. <a href="https://libjohn.github.io/openrefine/index.html">https://libjohn.github.io/openrefine/index.html</a>.
</div>
<div id="ref-hodgson_2020" class="csl-entry">
Munzer, Joe, and Tim Hodson. 2020. <span>“Developer Community - Bulk Tools.”</span> Talis Support. Talis. July 22, 2020. <a href="https://support.talis.com/hc/en-us/articles/360011227137-Developer-Community-Bulk-Tools">https://support.talis.com/hc/en-us/articles/360011227137-Developer-Community-Bulk-Tools</a>.
</div>
<div id="ref-tillman_2020" class="csl-entry">
Tillman, Ruth Kitchin. 2020. <span>“Learning Cell Cross in OpenRefine.”</span> Ruth Tillman. March 26, 2020. <a href="https://ruthtillman.com/talk/cell-cross-webinar-2020-03/">https://ruthtillman.com/talk/cell-cross-webinar-2020-03/</a>.
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
